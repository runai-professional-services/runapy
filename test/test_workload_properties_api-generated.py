# coding: utf-8

"""
Test file for WorkloadPropertiesApi
Generated by OpenAPI Generator with custom template
"""

import pytest
import unittest.mock as mock
from datetime import datetime, timezone
import json

from runai.configuration import Configuration
from runai.api_client import ApiClient
from runai.models import *
from runai.exceptions import ApiException


class TestWorkloadPropertiesApi:
    """Test cases for WorkloadPropertiesApi"""

    @pytest.fixture(autouse=True)
    def setup(self):
        """Setup test fixtures"""
        self.configuration = Configuration(
            client_id="test-client",
            client_secret="test-secret",
            runai_base_url="https://test.run.ai",
        )
        self.api_client = ApiClient(self.configuration)
        self.api = WorkloadPropertiesApi(self.api_client)

        # Mock the request method
        self.request_patcher = mock.patch.object(self.api_client.rest_client, "request")
        self.mock_request = self.request_patcher.start()
        yield
        self.request_patcher.stop()

    def test_create_workload_type(self):
        """Test case for create_workload_type

        Create a workload type. [Experimental] Create a new workload type in the system by providing its identification details and configuration, making it available for use and management within the platform.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_create_fields = (
            runai.WorkloadTypeCreateFields()
        )  # WorkloadTypeCreateFields | Workload type to create.

        # Make request
        response = self.api.create_workload_type(
            workload_type_create_fields=workload_type_create_fields,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "POST"
        assert "/api/v1/workload-types" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

        # Verify response
        assert isinstance(response, WorkloadTypeConfig)

    def test_create_workload_type_error(self):
        """Test error handling for create_workload_type"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_create_fields = runai.WorkloadTypeCreateFields()

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.create_workload_type(
                workload_type_create_fields=workload_type_create_fields,
            )
        assert exc_info.value.status == 400

    def test_delete_workload_type(self):
        """Test case for delete_workload_type

        Delete a workload type by id. [Experimental] Deletes a specific workload type by its ID.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"  # str | The unique identifier of the workload type.

        # Make request
        self.api.delete_workload_type(
            workload_type_id=workload_type_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "DELETE"
        assert "/api/v1/workload-types/{workloadTypeId}" in kwargs["url"]

    def test_delete_workload_type_error(self):
        """Test error handling for delete_workload_type"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.delete_workload_type(
                workload_type_id=workload_type_id,
            )
        assert exc_info.value.status == 400

    def test_get_category_by_id(self):
        """Test case for get_category_by_id

        Get workload category by id. Retrieves a specific workload category by its ID. Workload categories are used to classify and monitor different types of workloads within the NVIDIA Run:ai platform.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        category_id = "category_id_example"  # str | The unique identifier of the workload category.

        # Make request
        response = self.api.get_category_by_id(
            category_id=category_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/workload-categories/{categoryId}" in kwargs["url"]

        # Verify response
        assert isinstance(response, WorkloadCategory)

    def test_get_category_by_id_error(self):
        """Test error handling for get_category_by_id"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        category_id = "category_id_example"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_category_by_id(
                category_id=category_id,
            )
        assert exc_info.value.status == 400

    def test_get_workload_priorities(self):
        """Test case for get_workload_priorities

        Get workload priorities. Retrieve the list of all workload priorities available in the system
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        sort_order = asc  # str | Sort results in descending or ascending order.
        sort_by = "sort_by_example"  # str | Defines the field to sort the results by
        filter_by = [
            '["name!=some-name"]'
        ]  # List[str] | Filter results by a parameter. Use the format field-name operator value. Operators are == Equals, != Not equals, <= Less than or equal, >= Greater than or equal, =@ contains, !@ Does not contains, =^ Starts with and =$ Ends with. Dates are in ISO 8601 timestamp format and available for operators == None, != None, <= and >= None,

        # Make request
        response = self.api.get_workload_priorities()

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/workload-priorities" in kwargs["url"]

        # Verify query parameters
        assert "sortOrder=" in kwargs["url"]
        # Verify query parameters
        assert "sortBy=" in kwargs["url"]
        # Verify query parameters
        assert "filterBy=" in kwargs["url"]

        # Verify response
        assert isinstance(response, GetWorkloadPriorities200Response)

    def test_get_workload_priorities_error(self):
        """Test error handling for get_workload_priorities"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_workload_priorities()
        assert exc_info.value.status == 400

    def test_get_workload_type(self):
        """Test case for get_workload_type

        List workload type by id. Retrieves a specific workload type by its ID.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"  # str | The unique identifier of the workload type.

        # Make request
        response = self.api.get_workload_type(
            workload_type_id=workload_type_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/workload-types/{workloadTypeId}" in kwargs["url"]

        # Verify response
        assert isinstance(response, WorkloadTypeConfig)

    def test_get_workload_type_error(self):
        """Test error handling for get_workload_type"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_workload_type(
                workload_type_id=workload_type_id,
            )
        assert exc_info.value.status == 400

    def test_list_categories(self):
        """Test case for list_categories

        List workload categories. Retrieves a list of workload categories. These categories are used to classify and monitor different types of workloads within the NVIDIA Run:ai platform.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Make request
        response = self.api.list_categories()

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/workload-categories" in kwargs["url"]

        # Verify response
        assert isinstance(response, ListCategories200Response)

    def test_list_categories_error(self):
        """Test error handling for list_categories"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.list_categories()
        assert exc_info.value.status == 400

    def test_list_workload_types(self):
        """Test case for list_workload_types

        List workload types. Retrieves a list of workload types with their configurations - their corresponding workload categories and priorities.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        external_types_only = False  # bool | Return only external and user_external sourced workload types.
        filter_by = [
            '["name==Deployment","group==apps"]'
        ]  # List[str] | Filter results by a parameter. Use the format field-name operator value. Operators are `==` Equals, `!=` Not equals, `<=` Less than or equal, `>=` Greater than or equal, `=@` contains, `!@` Does not contain, `=^` Starts with and `=$` Ends with. Dates are in ISO 8601 timestamp format and available for operators `==`, `!=`, `<=` and `>=`.

        # Make request
        response = self.api.list_workload_types()

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/workload-types" in kwargs["url"]

        # Verify query parameters
        assert "externalTypesOnly=" in kwargs["url"]
        # Verify query parameters
        assert "filterBy=" in kwargs["url"]

        # Verify response
        assert isinstance(response, ListWorkloadTypes200Response)

    def test_list_workload_types_error(self):
        """Test error handling for list_workload_types"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.list_workload_types()
        assert exc_info.value.status == 400

    def test_update_workload_type(self):
        """Test case for update_workload_type

        Update a workload type by id. Update the default category or priority assigned to a workload type.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"  # str | The unique identifier of the workload type.
        workload_type_update_fields = (
            runai.WorkloadTypeUpdateFields()
        )  # WorkloadTypeUpdateFields | Workload type to update.

        # Make request
        response = self.api.update_workload_type(
            workload_type_id=workload_type_id,
            workload_type_update_fields=workload_type_update_fields,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "PUT"
        assert "/api/v1/workload-types/{workloadTypeId}" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

        # Verify response
        assert isinstance(response, WorkloadTypeConfig)

    def test_update_workload_type_error(self):
        """Test error handling for update_workload_type"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_type_id = "workload_type_id_example"
        workload_type_update_fields = runai.WorkloadTypeUpdateFields()

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.update_workload_type(
                workload_type_id=workload_type_id,
                workload_type_update_fields=workload_type_update_fields,
            )
        assert exc_info.value.status == 400
