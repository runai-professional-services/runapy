# coding: utf-8

"""
Test file for ServiceAccountsApi
Generated by OpenAPI Generator with custom template
"""

import pytest
import unittest.mock as mock
from datetime import datetime, timezone
import json

from runai.configuration import Configuration
from runai.api_client import ApiClient
from runai.models import *
from runai.exceptions import ApiException


class TestServiceAccountsApi:
    """Test cases for ServiceAccountsApi"""

    @pytest.fixture(autouse=True)
    def setup(self):
        """Setup test fixtures"""
        self.configuration = Configuration(
            client_id="test-client",
            client_secret="test-secret",
            runai_base_url="https://test.run.ai",
        )
        self.api_client = ApiClient(self.configuration)
        self.api = ServiceAccountsApi(self.api_client)

        # Mock the request method
        self.request_patcher = mock.patch.object(self.api_client.rest_client, "request")
        self.mock_request = self.request_patcher.start()
        yield
        self.request_patcher.stop()

    def test_create_service_account(self):
        """Test case for create_service_account

        Create a service account. Used to create a service account.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_creation_request = (
            runai.ServiceAccountCreationRequest()
        )  # ServiceAccountCreationRequest | Service account object to create

        # Make request
        response = self.api.create_service_account(
            service_account_creation_request=service_account_creation_request,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "POST"
        assert "/api/v1/service-accounts" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

        # Verify response
        assert isinstance(response, ServiceAccountPostResponse)

    def test_create_service_account_error(self):
        """Test error handling for create_service_account"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_creation_request = runai.ServiceAccountCreationRequest()

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.create_service_account(
                service_account_creation_request=service_account_creation_request,
            )
        assert exc_info.value.status == 400

    def test_delete_service_account_by_id(self):
        """Test case for delete_service_account_by_id

        Delete a service account by id. Use to delete a service account by id.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = (
            "6d2894ba-f998-4039-bba1-caba57caf681"  # str | Service account id
        )

        # Make request
        self.api.delete_service_account_by_id(
            service_account_id=service_account_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "DELETE"
        assert "/api/v1/service-accounts/{serviceAccountId}" in kwargs["url"]

    def test_delete_service_account_by_id_error(self):
        """Test error handling for delete_service_account_by_id"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = "6d2894ba-f998-4039-bba1-caba57caf681"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.delete_service_account_by_id(
                service_account_id=service_account_id,
            )
        assert exc_info.value.status == 400

    def test_get_service_account_by_id(self):
        """Test case for get_service_account_by_id

        Get service account by id. Retrieve the details of a service account by id.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = (
            "6d2894ba-f998-4039-bba1-caba57caf681"  # str | Service account id
        )

        # Make request
        response = self.api.get_service_account_by_id(
            service_account_id=service_account_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/service-accounts/{serviceAccountId}" in kwargs["url"]

        # Verify response
        assert isinstance(response, ServiceAccount)

    def test_get_service_account_by_id_error(self):
        """Test error handling for get_service_account_by_id"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = "6d2894ba-f998-4039-bba1-caba57caf681"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_service_account_by_id(
                service_account_id=service_account_id,
            )
        assert exc_info.value.status == 400

    def test_get_service_accounts(self):
        """Test case for get_service_accounts

        Get a list of service accounts. Retrieve a list of service accounts.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Make request
        response = self.api.get_service_accounts()

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v1/service-accounts" in kwargs["url"]

        # Verify response
        assert isinstance(response, List[ServiceAccount])

    def test_get_service_accounts_error(self):
        """Test error handling for get_service_accounts"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_service_accounts()
        assert exc_info.value.status == 400

    def test_regenerate_service_account_secret(self):
        """Test case for regenerate_service_account_secret

        Regenerate a service account secret. Use to regenerate the service account secret by id.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = (
            "6d2894ba-f998-4039-bba1-caba57caf681"  # str | Service account id
        )

        # Make request
        response = self.api.regenerate_service_account_secret(
            service_account_id=service_account_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "POST"
        assert "/api/v1/service-accounts/{serviceAccountId}/secret" in kwargs["url"]

        # Verify response
        assert isinstance(response, RegenerateServiceAccountSecretResponse)

    def test_regenerate_service_account_secret_error(self):
        """Test error handling for regenerate_service_account_secret"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = "6d2894ba-f998-4039-bba1-caba57caf681"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.regenerate_service_account_secret(
                service_account_id=service_account_id,
            )
        assert exc_info.value.status == 400

    def test_update_service_account_by_id(self):
        """Test case for update_service_account_by_id

        Update service account details by id. Use to update the details of a service account by id.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = (
            "6d2894ba-f998-4039-bba1-caba57caf681"  # str | Service account id
        )
        service_account_patch_request = (
            runai.ServiceAccountPatchRequest()
        )  # ServiceAccountPatchRequest | Service account object that needs to be updated.

        # Make request
        self.api.update_service_account_by_id(
            service_account_id=service_account_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "PATCH"
        assert "/api/v1/service-accounts/{serviceAccountId}" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

    def test_update_service_account_by_id_error(self):
        """Test error handling for update_service_account_by_id"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        service_account_id = "6d2894ba-f998-4039-bba1-caba57caf681"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.update_service_account_by_id(
                service_account_id=service_account_id,
            )
        assert exc_info.value.status == 400
