# coding: utf-8

"""
Test file for WorkloadsV2Api
Generated by OpenAPI Generator with custom template
"""

import pytest
import unittest.mock as mock
from datetime import datetime, timezone
import json

from runai.configuration import Configuration
from runai.api_client import ApiClient
from runai.models import *
from runai.exceptions import ApiException


class TestWorkloadsV2Api:
    """Test cases for WorkloadsV2Api"""

    @pytest.fixture(autouse=True)
    def setup(self):
        """Setup test fixtures"""
        self.configuration = Configuration(
            client_id="test-client",
            client_secret="test-secret",
            runai_base_url="https://test.run.ai",
        )
        self.api_client = ApiClient(self.configuration)
        self.api = WorkloadsV2Api(self.api_client)

        # Mock the request method
        self.request_patcher = mock.patch.object(self.api_client.rest_client, "request")
        self.mock_request = self.request_patcher.start()
        yield
        self.request_patcher.stop()

    def test_create_workload_v2(self):
        """Test case for create_workload_v2

        Create a workload. [Experimental] Submit a workload with metadata and a Kubernetes manifest.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_create_request = (
            runai.WorkloadV2CreateRequest()
        )  # WorkloadV2CreateRequest | Workload metadata and manifest

        # Make request
        response = self.api.create_workload_v2(
            workload_v2_create_request=workload_v2_create_request,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "POST"
        assert "/api/v2/workloads" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

        # Verify response
        assert isinstance(response, WorkloadV2)

    def test_create_workload_v2_error(self):
        """Test error handling for create_workload_v2"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_create_request = runai.WorkloadV2CreateRequest()

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.create_workload_v2(
                workload_v2_create_request=workload_v2_create_request,
            )
        assert exc_info.value.status == 400

    def test_delete_workload_v2(self):
        """Test case for delete_workload_v2

        Delete a workload. [Experimental] Delete a specific workload by ID
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"  # str |

        # Make request
        response = self.api.delete_workload_v2(
            workload_v2_id=workload_v2_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "DELETE"
        assert "/api/v2/workloads/{WorkloadV2Id}" in kwargs["url"]

        # Verify response
        assert isinstance(response, WorkloadV2)

    def test_delete_workload_v2_error(self):
        """Test error handling for delete_workload_v2"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.delete_workload_v2(
                workload_v2_id=workload_v2_id,
            )
        assert exc_info.value.status == 400

    def test_get_workload_v2_by_id(self):
        """Test case for get_workload_v2_by_id

        Get a specific workload. [Experimental] Retrieve details of a specific workload by ID
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"  # str |

        # Make request
        response = self.api.get_workload_v2_by_id(
            workload_v2_id=workload_v2_id,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "GET"
        assert "/api/v2/workloads/{WorkloadV2Id}" in kwargs["url"]

        # Verify response
        assert isinstance(response, WorkloadV2GetResponse)

    def test_get_workload_v2_by_id_error(self):
        """Test error handling for get_workload_v2_by_id"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.get_workload_v2_by_id(
                workload_v2_id=workload_v2_id,
            )
        assert exc_info.value.status == 400

    def test_update_workload_v2(self):
        """Test case for update_workload_v2

        Update workload spec. [Experimental] Update the specification of an existing workload.
        """
        # Mock response
        mock_response = mock.Mock()
        mock_response.status = 200
        mock_response.read.return_value = json.dumps({"data": {}})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"  # str |
        workload_v2_update_request = (
            runai.WorkloadV2UpdateRequest()
        )  # WorkloadV2UpdateRequest |

        # Make request
        response = self.api.update_workload_v2(
            workload_v2_id=workload_v2_id,
            workload_v2_update_request=workload_v2_update_request,
        )

        # Verify request was made
        assert self.mock_request.called
        args, kwargs = self.mock_request.call_args

        # Verify request method and URL
        assert kwargs["method"] == "PUT"
        assert "/api/v2/workloads/{WorkloadV2Id}" in kwargs["url"]

        # Verify body
        assert kwargs["body"] is not None

        # Verify response
        assert isinstance(response, WorkloadV2)

    def test_update_workload_v2_error(self):
        """Test error handling for update_workload_v2"""
        # Mock error response
        mock_response = mock.Mock()
        mock_response.status = 400
        mock_response.read.return_value = json.dumps({"message": "Error message"})
        self.mock_request.return_value = mock_response

        # Test parameters
        workload_v2_id = "workload_v2_id_example"
        workload_v2_update_request = runai.WorkloadV2UpdateRequest()

        # Verify error handling
        with pytest.raises(ApiException) as exc_info:
            self.api.update_workload_v2(
                workload_v2_id=workload_v2_id,
                workload_v2_update_request=workload_v2_update_request,
            )
        assert exc_info.value.status == 400
